**Art Work Management**

![Diagram for the Project](Assets/Diagram.png)

## Download Oracle database
> Download the  ([Oracle Database 11g Express Edition](https://www.oracle.com/database/technologies/xe-prior-release-downloads.html)) and install the software.
> Remember the password during the installation because this password is used for connecting the database account.


![alt text](Assets/installation.png)

> Open Run SQL Command line and type the following command and use to password set in the installation process. You may not see the password but don't worry it is getting typed.


```
connect system;
connect / as sysdba
```

>To change the password : 

```
alter user system identified by [password]
```

>To drop the table:

```
DROP TABLE [TABLE_NAME]
```

>CREATE ARTIST , ART_WORK , CUSTOMER TABLES:

```
CREATE TABLE ARTIST(
ARTIST_ID INT PRIMARY KEY,
NAME VARCHAR(45),
BIRTHPLACE VARCHAR(80),
STYLE_OF_ART VARCHAR(100)
);


CREATE TABLE ART_WORK(
ART_ID INT,
ARTWORK_ID INT PRIMARY KEY,
TITLE VARCHAR(50),
DATE_OF_CREATION DATE,
TYPE VARCHAR(100),
PRICE INT,
FOREIGN KEY (ART_ID) REFERENCES ARTIST(ARTIST_ID)
ON DELETE CASCADE;
);


CREATE TABLE CUSTOMER(
ID INT PRIMARY KEY,
NAME VARCHAR(50),
ADDRESS VARCHAR(100),
PHONE INT,
PURCHASED_ID INT,
FOREIGN KEY (PURCHASED_ID) REFERENCES ART_WORK(ARTWORK_ID)
ON DELETE CASCADE;
);
```

>INSERT INTO THE TABLES:

```
INSERT INTO ARTIST (ARTIST_ID, NAME, BIRTHPLACE, STYLE_OF_ART) VALUES (1, 'Leonardo da Vinci', 'Vinci, Italy', 'Renaissance');
INSERT INTO ARTIST (ARTIST_ID, NAME, BIRTHPLACE, STYLE_OF_ART) VALUES (2, 'Vincent van Gogh', 'Zundert, Netherlands', 'Post-Impressionism');
INSERT INTO ARTIST (ARTIST_ID, NAME, BIRTHPLACE, STYLE_OF_ART) VALUES (3, 'Pablo Picasso', 'MÃ¡laga, Spain', 'Cubism');
INSERT INTO ARTIST (ARTIST_ID, NAME, BIRTHPLACE, STYLE_OF_ART) VALUES (4, 'Michelangelo', 'Caprese, Italy', 'High Renaissance');
INSERT INTO ARTIST (ARTIST_ID, NAME, BIRTHPLACE, STYLE_OF_ART) VALUES (5, 'Rembrandt van Rijn', 'Leiden, Netherlands', 'Baroque');



-- Inserting data into the ART_WORK table
INSERT INTO ART_WORK (ART_ID, ARTWORK_ID, TITLE, DATE_OF_CREATION, TYPE, PRICE) 
VALUES (1, 1, 'Mona Lisa', TO_DATE('1503-01-01', 'YYYY-MM-DD'), 'Painting', 100000000);

INSERT INTO ART_WORK (ART_ID, ARTWORK_ID, TITLE, DATE_OF_CREATION, TYPE, PRICE) 
VALUES (1, 4, 'The Vitruvian Man', TO_DATE('1203-01-01', 'YYYY-MM-DD'), 'Painting', 984343);

INSERT INTO ART_WORK (ART_ID, ARTWORK_ID, TITLE, DATE_OF_CREATION, TYPE, PRICE) 
VALUES (1, 7, 'Santa Maria Della Neve', TO_DATE('1119-01-01', 'YYYY-MM-DD'), 'Painting', 3456767344);

INSERT INTO ART_WORK (ART_ID, ARTWORK_ID, TITLE, DATE_OF_CREATION, TYPE, PRICE) 
VALUES (2, 2, 'Starry Night', TO_DATE('1889-01-01', 'YYYY-MM-DD'), 'Painting', 80000000);

INSERT INTO ART_WORK (ART_ID, ARTWORK_ID, TITLE, DATE_OF_CREATION, TYPE, PRICE) 
VALUES (3, 3, 'Les Demoiselles d''Avignon', TO_DATE('1907-01-01', 'YYYY-MM-DD'), 'Painting', 120000000);


--Inserting into CUSTOMER table
INSERT INTO CUSTOMER (ID, NAME, ADDRESS, PHONE, PURCHASED_ID) VALUES (1, 'John Doe', '123 Main St, Anytown', '+1234567890', 1);
INSERT INTO CUSTOMER (ID, NAME, ADDRESS, PHONE, PURCHASED_ID) VALUES (2, 'Jane Smith', '456 Elm St, Othertown', '+9876543210', 2);
INSERT INTO CUSTOMER (ID, NAME, ADDRESS, PHONE, PURCHASED_ID) VALUES (3, 'Alice Johnson', '789 Oak St, Anothertown', '+1112223333', 3);
INSERT INTO CUSTOMER (ID, NAME, ADDRESS, PHONE, PURCHASED_ID) VALUES (4, 'SOHEL', '789 Oak St, Anothertown', '+0232231', 4);
INSERT INTO CUSTOMER (ID, NAME, ADDRESS, PHONE, PURCHASED_ID) VALUES (10, 'MD Ustadh Abu Taheri', 'Gopalgonj , 10 Banghabandhu Street', '+4523333', 7);
```


>GETTING THE INFORMATION OF THE ARTIST WHOSE ART-WORK IS PURCHASED BY John Doe:

```
SELECT * FROM ARTIST WHERE ARTIST_ID = (SELECT ART_ID FROM ART_WORK WHERE ARTWORK_ID = (SELECT ID FROM CUSTOMER WHERE NAME = 'John Doe'));
```
![NESTED SUBQUERY 1](Assets/NESTED%20SUB_Q%20(1).png)

>GETTING THE INFO OF THE ART WORK BOUGHT BY THE CUSTOMER WITH ID = 1:

```
SELECT * FROM ART_WORK WHERE ARTWORK_ID = (SELECT PURCHASED_ID FROM CUSTOMER WHERE ID = 1);
```
![NESTED SUBQUERY 2](Assets/NESTED%20SUB_Q%20(2).png)


>UPDATING DATA IN ARTIST TABLE USING NESTED SUBQUERY:

```
UPDATE ARTIST SET NAME = 'SOHEL' WHERE ARTIST_ID = (SELECT ART_ID FROM ART_WORK WHERE ARTWORK_ID = (SELECT PURCHASED_ID FROM CUSTOMER WHERE ID = 1));
UPDATE ARTIST SET NAME = 'Leonardo da Vinci' WHERE ARTIST_ID = 1;
```


>DELETING DATA FROM THE ARTIST TABLE:
```
INSERT INTO ARTIST (ARTIST_ID, NAME, BIRTHPLACE, STYLE_OF_ART) VALUES (10, 'Leonardo da Vinci', 'KUET', 'Renaissance');
DELETE FROM ARTIST WHERE ARTIST_ID = 10;
```

>THIS COMMAND WILL JOIN THE ROWS OF THE THREE TABLES BASED ON COMMON VALUES. ARTIST TABLE'S ARTIST ID IS REFERENCED BY THE ART_ID FROM THE ART_WORK TABLE. ARTWORK_ID COLUMN IS REFERENCED BY THE PURCHASED_ID FROM THE CUSTOMER TABLE. THIS COMMAND WILL PERFROM THE JOIN OPERATION ON THIS COMMON COLUMNS:

```
SELECT * FROM ARTIST JOIN ART_WORK ON ARTIST.ARTIST_ID = ART_WORK.ART_ID JOIN CUSTOMER ON ART_WORK.ARTWORK_ID = CUSTOMER.PURCHASED_ID;
```

![COMPLEX JOIN OPERATION](Assets/JOIN%20ON%20THREE%20TABLES.png)

>PROCEDURE TO ADD DATA IN THE ARTIST TABLE:

```
CREATE OR REPLACE PROCEDURE INSERT_ARTIST(
    ID IN INT,
    NAME IN VARCHAR2,
    BIRTHPLACE IN VARCHAR2,
    STYLE_OF_ART IN VARCHAR2
) AS
BEGIN
    INSERT INTO ARTIST (ARTIST_ID, NAME, BIRTHPLACE, STYLE_OF_ART)
    VALUES (ID, NAME, BIRTHPLACE, STYLE_OF_ART);
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('Artist record inserted successfully.');
END;
/

```
>COMPILE THE PROCEDURE AND SIMPLY CALL IT BY ANY OF THE FOLLOWING COMMANDS:
```
CALL INSERT_ARTIST(1112 , 'TAHER' , 'DHAMRAI' , 'DEMO');
EXECUTE INSERT_ARTIST(1112 , 'TAHER' , 'DHAMRAI' , 'DEMO');
```
>PROCEDURE TO DELETE ARTIST RECORD BY ID:

```
CREATE OR REPLACE PROCEDURE DELETE_ARTIST(D_ID IN INT)
AS
MSG CHAR(300);
BEGIN

MSG := 'ARTIST RECORD SUCCESSFULLY DELETED';
DELETE FROM ARTIST WHERE ARTIST_ID = D_ID;
COMMIT;
DBMS_OUTPUT.PUT_LINE(MSG);
EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        DBMS_OUTPUT.PUT_LINE('ERROR');
END;
/
```

>IF WE WANT TO DELETE A RECORD FROM THE ART_WORK TABLE BY THE COMMAND:

```
DELETE FROM ART_WORK WHERE ART_ID = 1;
```

>SHOW THE DETAILS OF ARTISTS WHO HAVE SOLD AT LEAST ONE PAINTING USING CURSOR AND PROCEDURE:


```
CREATE OR REPLACE PROCEDURE RETRIEVE_RICH_ARTISTS IS
  CURSOR ARTIST_CURSOR IS SELECT * FROM ARTIST WHERE ARTIST.ARTIST_ID IN (SELECT ART_ID FROM ART_WORK WHERE ARTWORK_ID IN (SELECT CUSTOMER.PURCHASED_ID FROM CUSTOMER));
  ARTIST_ROW ARTIST%ROWTYPE;
BEGIN
  OPEN ARTIST_CURSOR;
  FETCH ARTIST_CURSOR INTO ARTIST_ROW;
  WHILE ARTIST_CURSOR%FOUND
  LOOP
    DBMS_OUTPUT.PUT_LINE('Artist ID: ' || ARTIST_ROW.ARTIST_ID || ', Name: ' || ARTIST_ROW.NAME);
    DBMS_OUTPUT.PUT_LINE('Birthplace: ' || ARTIST_ROW.BIRTHPLACE || ', Style of Art: ' || ARTIST_ROW.STYLE_OF_ART);
    DBMS_OUTPUT.PUT_LINE('----------------------------------------');
    FETCH ARTIST_CURSOR INTO ARTIST_ROW;
  END LOOP;
  CLOSE ARTIST_CURSOR;
END;
/
```

![FULL DATA](/Assets/PROCEDURE%20USING%20CURSOR(1).png)
![AFTER PROC CALL](/Assets/PROCEDURE%20USING%20CURSOR.png)

>CREATE TRIGGER TO DELETE RECORDS FROM ART_WORK TABLE AND CUSTOMER TABLE WHENEVER A RECORD IS BEING DELETED FROM THE ARTIST TABLE:

```
CREATE OR REPLACE TRIGGER DLT_FROM_ARTIST
BEFORE DELETE ON ARTIST
FOR EACH ROW
BEGIN
    DBMS_OUTPUT.PUT_LINE('Old Artist ID: ' || :OLD.ARTIST_ID);
    DELETE FROM ART_WORK WHERE ART_ID = :OLD.ARTIST_ID;
    DELETE FROM CUSTOMER WHERE PURCHASED_ID IN (SELECT ARTWORK_ID FROM ART_WORK WHERE ART_WORK.ART_ID = :OLD.ARTIST_ID);
    DBMS_OUTPUT.PUT_LINE('SUCCESSFULLY DELETED FROM ART_WORK AND CUSTOMER TABLE');
END;
/
```

>TIP REMEMBER TO ADD ':' BEFORE USING THE OLD PSEUDORECORD. OTHERWISE IT WILL SHOW ERRORS.


>FUNCTION TO CALCULATE THE TOTAL SALES AMOUNT FOR AN ARTIST USING THE ARTIST_ID :

```
CREATE OR REPLACE FUNCTION CALCULATE_TOTAL_SALES_AMOUNT(
    ARTIST_ID IN INT
) RETURN INT AS
    ANS INT := 0;
BEGIN
    SELECT SUM(ART_WORK.PRICE) INTO ANS FROM ART_WORK JOIN CUSTOMER ON ART_WORK.ARTWORK_ID = CUSTOMER.PURCHASED_ID
    WHERE ART_WORK.ART_ID =  ARTIST_ID;
    RETURN ANS;
END;
/
```

>COUNTING NUMBER OF ART_WORK CREATED BY AN ARTIST BASED ON THE ARTIST_ID AND THEN SHOWING THE TITLES OF THE ARTWORKS USING THE ANONYMOUS PROCEDURE AND IF/ELSE :


```
DECLARE
    ARTIST_ID INT := 1;
    ARTWORK_COUNT INT;
BEGIN

    SELECT COUNT(*) INTO ARTWORK_COUNT FROM ART_WORK WHERE ART_ID = ARTIST_ID;

    IF ARTWORK_COUNT = 0 THEN
        DBMS_OUTPUT.PUT_LINE('No artworks found for the artist with ID: ' || ARTIST_ID);
    
    ELSIF ARTWORK_COUNT > 0 THEN
    
        FOR artwork IN (SELECT * FROM ART_WORK WHERE ART_ID = ARTIST_ID)
        LOOP
            DBMS_OUTPUT.PUT_LINE('Artwork ID: ' || artwork.ARTWORK_ID || ', Title: ' || artwork.TITLE);
        END LOOP;
    END IF;
END;
/
```

